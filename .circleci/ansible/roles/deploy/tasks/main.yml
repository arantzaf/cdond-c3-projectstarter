---
- name: "Copy artifact zip"
  ansible.builtin.copy:
    src: /root/project/artifact.tar.gz
    dest: ~/artifact.tar.gz

- name: "extract zip file"
  shell: |
    cd ~/
    tar -xvzf artifact.tar.gz

- name: "install dependencies"
  shell: |
    npm i

- name: "start node"
  shell: |
    cd dist
    pm2 delete all
    pm2 start main.js
  register: start_node

- name: print response
  debug: |
    msg: "{{start_node.stdout_lines}}"
